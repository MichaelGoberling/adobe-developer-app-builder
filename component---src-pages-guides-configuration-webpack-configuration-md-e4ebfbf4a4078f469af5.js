"use strict";(self.webpackChunkadobe_developer_app_builder=self.webpackChunkadobe_developer_app_builder||[]).push([[2017],{52566:function(n,e,i){i.r(e),i.d(e,{_frontmatter:function(){return d},default:function(){return u}});var a=i(87462),o=i(63366),t=(i(15007),i(64983)),l=i(91515),r=["components"],d={},p={_frontmatter:d},m=l.Z;function u(n){var e=n.components,i=(0,o.Z)(n,r);return(0,t.mdx)(m,(0,a.Z)({},p,i,{components:e,mdxType:"MDXLayout"}),(0,t.mdx)("h1",{id:"webpack-configuration"},"Webpack Configuration"),(0,t.mdx)("h2",{id:"overview"},"Overview"),(0,t.mdx)("p",null,"App Builder bundles Runtime action code using Webpack. Users can specify a Webpack configuration for an individual action, a set of actions,\nor an entire project. See ",(0,t.mdx)("a",{parentName:"p",href:"https://webpack.js.org/configuration/#options"},"here")," for Webpack configuration options."),(0,t.mdx)("h2",{id:"configuration-file"},"Configuration File"),(0,t.mdx)("p",null,"When Runtime action code is bundled during ",(0,t.mdx)("inlineCode",{parentName:"p"},"aio app build|run|deploy")," the action directory is searched for a webpack config file named ",(0,t.mdx)("inlineCode",{parentName:"p"},"*webpack-config.js"),". The search is done first in the directory of the action being built, then the parent directory, up to the project root."),(0,t.mdx)("p",null,"If you want to specify a Webpack configuration for a single action, place the ",(0,t.mdx)("inlineCode",{parentName:"p"},"*webpack-config.js")," file in the action folder."),(0,t.mdx)("p",null,"If you want to specify a Webpack configuration for a set of actions, place the ",(0,t.mdx)("inlineCode",{parentName:"p"},"*webpack-config.js")," file in the parent directory of your action\nfolders."),(0,t.mdx)("p",null,"If you want to specify a Webpack configuration for an entire project, place the ",(0,t.mdx)("inlineCode",{parentName:"p"},"*webpack-config.js")," file in the root directory of your project."),(0,t.mdx)("h3",{id:"es-module-syntax"},"ES Module Syntax"),(0,t.mdx)("p",null,"App Builder currently does not support ES Module syntax. This file must be written in CommonJS otherwise failures will occur at build time. "),(0,t.mdx)("h2",{id:"configuration-types"},"Configuration Types"),(0,t.mdx)("p",null,"App Builder supports exporting the following configuration types in ",(0,t.mdx)("inlineCode",{parentName:"p"},"*webpack-config.js"),"."),(0,t.mdx)("h3",{id:"object"},"Object"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = { \n  mode: 'development' \n}\n")),(0,t.mdx)("h3",{id:"function-that-returns-an-object"},"Function that returns an object"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = (env) => ({\n  mode: 'development'\n})\n")),(0,t.mdx)("h3",{id:"function-that-returns-an-array-of-objects"},"Function that returns an array of objects"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = (env) => ([\n  {\n    mode: 'development' \n  },\n  {\n    mode: 'production'\n  }\n])\n")),(0,t.mdx)("h3",{id:"async-function-that-returns-an-object"},"Async function that returns an object"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = async (env) => ({\n  mode: 'development'\n})\n")),(0,t.mdx)("h3",{id:"async-function-that-returns-an-array-of-objects"},"Async function that returns an array of objects"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = async (env) => ([\n  {\n    mode: 'development' \n  },\n  {\n    mode: 'production'\n  }\n])\n")),(0,t.mdx)("h3",{id:"array-of-objects"},"Array of objects"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = [\n  {\n    mode: 'development'\n  },\n  {\n    mode: 'production'\n  }\n]\n")),(0,t.mdx)("h3",{id:"array-of-functions-that-return-objects"},"Array of functions that return objects"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = [\n  (env) => ({\n    mode: 'development'\n  }),\n  (env) => ({\n    mode: 'production'\n  })\n]\n")),(0,t.mdx)("h3",{id:"array-of-async-functions-that-return-objects"},"Array of async functions that return objects"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = [\n  async (env) => ({\n    mode: 'development'\n  }),\n  async (env) => ({\n    mode: 'production'\n  })\n]\n")),(0,t.mdx)("h2",{id:"configuration"},"Configuration"),(0,t.mdx)("h3",{id:"overview-1"},"Overview"),(0,t.mdx)("p",null,"Assuming ",(0,t.mdx)("inlineCode",{parentName:"p"},"config")," contains your Webpack configuration:"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-javascript"},"{\n  mode: config.mode || 'production', \n  optimization: {\n    minimize: config.optimization.minimize || false\n  },\n  output: { \n    libraryTarget: config.output.libraryTarget || 'commonjs2',\n    path: './dist/${actionPath}/${actionName}-temp/' // Cannot change \n    fileName: `${output.path}/index.js` // Cannot change \n  },\n  target: 'node' // Cannot change\n  entry: [\n    '<path to the action>', \n    ...config.entry\n  ],\n  resolve: { \n    extensions: [\n      '.js', \n      '.json', \n      ...config.extensions\n    ],\n    mainFields: [ \n      'main',\n      ...config.mainFields\n    ]\n  },\n  plugins: [\n    new DefaultPlugin({\n      WEBPACK_ACTION_BUILD: 'true', \n      `process.env.AIO_CLI_ENV`: ${cliEnv}\n    }),\n    ...config.plugins\n  ]\n  \n  // ... All other Webpack configuration options are valid\n\n}\n")),(0,t.mdx)("h3",{id:"base-options"},"Base Options"),(0,t.mdx)("p",null,"App Builder starts off with the following Webpack configuration options, any additional values will be added on for these fields:"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("inlineCode",{parentName:"li"},"entry")," - Will always contain the path to the action, additional paths identified in your configuration file will be added on."),(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("inlineCode",{parentName:"li"},"resolve.extensions")," - Will always contain ",(0,t.mdx)("inlineCode",{parentName:"li"},".js")," and ",(0,t.mdx)("inlineCode",{parentName:"li"},".json"),", additional extensions identified in your configuration file will be added on."),(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("inlineCode",{parentName:"li"},"resolve.mainFields")," - Will always contain ",(0,t.mdx)("inlineCode",{parentName:"li"},"main"),", additional main fields identified in your configuration file will be added on.")),(0,t.mdx)("h3",{id:"defaults"},"Defaults"),(0,t.mdx)("p",null,"App Builder defaults to the following Webpack configuration options if they are not present in your configuration file:"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("inlineCode",{parentName:"li"},"output.libraryTarget")," - Will default to ",(0,t.mdx)("inlineCode",{parentName:"li"},"commonjs2"),"."),(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("inlineCode",{parentName:"li"},"mode")," - Will default to ",(0,t.mdx)("inlineCode",{parentName:"li"},"production"),"."),(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("inlineCode",{parentName:"li"},"optimization.minimize")," - Will default to ",(0,t.mdx)("inlineCode",{parentName:"li"},"false"),".")),(0,t.mdx)("h3",{id:"immutable-options"},"Immutable Options"),(0,t.mdx)("p",null,"App Builder does not allow changing of the following Webpack configuration options. These fields will be ignored if present in your configuration file:"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("inlineCode",{parentName:"li"},"target")," - This must be ",(0,t.mdx)("inlineCode",{parentName:"li"},"node"),". I/O Runtime only supports Node.js as a runtime."),(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("inlineCode",{parentName:"li"},"output.path")," - Will always be ",(0,t.mdx)("inlineCode",{parentName:"li"},"./dist/${actionPath}/${actionName}-temp/"),"."),(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("inlineCode",{parentName:"li"},"output.filename")," - Will always be ",(0,t.mdx)("inlineCode",{parentName:"li"},"${output.path}/index.js"),".",(0,t.mdx)("ul",{parentName:"li"},(0,t.mdx)("li",{parentName:"ul"},"Note: If supplying multiple configurations, this is true for the first configuration. For all subsequent configurations, it will be ",(0,t.mdx)("inlineCode",{parentName:"li"},"${output.path}/index.[hashname].js"),".")))),(0,t.mdx)("h2",{id:"environment-variables"},"Environment Variables"),(0,t.mdx)("p",null,"If you have chosen to export a function, an async function, or an array of functions from your Webpack configuration file, App Builder will pass the environment to these functions. You can use this, for instance, to make decisions about bundling based on the environment."),(0,t.mdx)("p",null,"Example: If you exported an environment variable called ",(0,t.mdx)("inlineCode",{parentName:"p"},"FEATURE_FLAG_PIRATES_BOUNTY")," before building your application, you can use this in your Webpack configuration file:"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = (env) => ({\n  mode: env.FEATURE_FLAG_PIRATES_BOUNTY ? 'production' : 'development'\n})\n")))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-configuration-webpack-configuration-md-e4ebfbf4a4078f469af5.js.map