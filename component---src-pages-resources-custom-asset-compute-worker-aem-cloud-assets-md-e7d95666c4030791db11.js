"use strict";(self.webpackChunkadobe_developer_app_builder=self.webpackChunkadobe_developer_app_builder||[]).push([[9908],{53491:function(e,a,t){t.r(a),t.d(a,{_frontmatter:function(){return p},default:function(){return l}});var s=t(87462),o=t(63366),i=(t(15007),t(64983)),r=t(91515),n=["components"],p={},d={_frontmatter:p},c=r.Z;function l(e){var a=e.components,t=(0,o.Z)(e,n);return(0,i.mdx)(c,(0,s.Z)({},d,t,{components:a,mdxType:"MDXLayout"}),(0,i.mdx)("h1",{id:"how-aem-as-cloud-assets-works"},"How AEM as Cloud assets works"),(0,i.mdx)("p",null,"Asset binaries are no longer processed by the AEM instance. AEM only coordinates access to the Azure Blob storage where binaries are stored."),(0,i.mdx)("p",null,(0,i.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"713px"}},"\n      ",(0,i.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"55.93750000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,i.mdx)("picture",{parentName:"span"},"\n          ",(0,i.mdx)("source",{parentName:"picture",srcSet:["/adobe-developer-app-builder/static/c4858b3c4c344b0264a2e25bf6aa0581/5530d/aemcloud-assets-overview.webp 320w","/adobe-developer-app-builder/static/c4858b3c4c344b0264a2e25bf6aa0581/0c8fb/aemcloud-assets-overview.webp 640w","/adobe-developer-app-builder/static/c4858b3c4c344b0264a2e25bf6aa0581/e185d/aemcloud-assets-overview.webp 713w"],sizes:"(max-width: 713px) 100vw, 713px",type:"image/webp"}),"\n          ",(0,i.mdx)("source",{parentName:"picture",srcSet:["/adobe-developer-app-builder/static/c4858b3c4c344b0264a2e25bf6aa0581/8980b/aemcloud-assets-overview.jpg 320w","/adobe-developer-app-builder/static/c4858b3c4c344b0264a2e25bf6aa0581/56d4e/aemcloud-assets-overview.jpg 640w","/adobe-developer-app-builder/static/c4858b3c4c344b0264a2e25bf6aa0581/3cc4a/aemcloud-assets-overview.jpg 713w"],sizes:"(max-width: 713px) 100vw, 713px",type:"image/jpeg"}),"\n          ",(0,i.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/adobe-developer-app-builder/static/c4858b3c4c344b0264a2e25bf6aa0581/3cc4a/aemcloud-assets-overview.jpg",alt:"AEM as Cloud - Assets overview",title:"AEM as Cloud - Assets overview",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,i.mdx)("p",null,"The right-hand red box on the diagram called ",(0,i.mdx)("strong",{parentName:"p"},"Asset microservices")," are the services that are driven by Adobe Asset Compute which is built on top of Adobe IO Runtime. The aim of this service is to:"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Perform any kind of asset binary transformation, such as: resizing, cropping, intelligent cropping, colours\nmanipulation or anything else you can imagine"),(0,i.mdx)("li",{parentName:"ul"},"An image transformation is driven by the Adobe's internal services for image manipulation or by 3rd-party services in\ncase of custom implementation."),(0,i.mdx)("li",{parentName:"ul"},"Store the result of the processing back to AEM as an asset rendition.")),(0,i.mdx)("p",null,"The high level architecture of the Asset Compute service is shown below."),(0,i.mdx)("p",null,(0,i.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"942px"}},"\n      ",(0,i.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"59.68750000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,i.mdx)("picture",{parentName:"span"},"\n          ",(0,i.mdx)("source",{parentName:"picture",srcSet:["/adobe-developer-app-builder/static/4c6d83a6b68034e2b97cd987ac999f3a/5530d/asset-compute-overview.webp 320w","/adobe-developer-app-builder/static/4c6d83a6b68034e2b97cd987ac999f3a/0c8fb/asset-compute-overview.webp 640w","/adobe-developer-app-builder/static/4c6d83a6b68034e2b97cd987ac999f3a/7c9ed/asset-compute-overview.webp 942w"],sizes:"(max-width: 942px) 100vw, 942px",type:"image/webp"}),"\n          ",(0,i.mdx)("source",{parentName:"picture",srcSet:["/adobe-developer-app-builder/static/4c6d83a6b68034e2b97cd987ac999f3a/8980b/asset-compute-overview.jpg 320w","/adobe-developer-app-builder/static/4c6d83a6b68034e2b97cd987ac999f3a/56d4e/asset-compute-overview.jpg 640w","/adobe-developer-app-builder/static/4c6d83a6b68034e2b97cd987ac999f3a/58df5/asset-compute-overview.jpg 942w"],sizes:"(max-width: 942px) 100vw, 942px",type:"image/jpeg"}),"\n          ",(0,i.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/adobe-developer-app-builder/static/4c6d83a6b68034e2b97cd987ac999f3a/58df5/asset-compute-overview.jpg",alt:"Asset Compute service architecture",title:"Asset Compute service architecture",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,i.mdx)("p",null,"A usual flow of the data goes through the following steps:"),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},"Once an asset is uploaded, AEM sends a processing job to the Asset Compute service.",(0,i.mdx)("ul",{parentName:"li"},(0,i.mdx)("li",{parentName:"ul"},"A job carries information such as the location of the source asset (on azure blob storage), desired rendition\nformat (png, jpg, etc.), rendition sizes and/or quality, etc."),(0,i.mdx)("li",{parentName:"ul"},"Optionally, the job can hold extra parameters defined on AEM if a custom worker is used."))),(0,i.mdx)("li",{parentName:"ol"},"Asset Compute service immediately returns the job ID back to the AEM and dispatches the job among available workers:",(0,i.mdx)("ul",{parentName:"li"},(0,i.mdx)("li",{parentName:"ul"},"As you can see from the diagram, workers can be Adobe built-in workers or a custom worker, this is the thing we're\nabout to build in this article."))),(0,i.mdx)("li",{parentName:"ol"},"When the worker is invoked, it usually downloads the source asset from the binary cloud storage and either forwards\nit to the third-party service for processing or does the image processing itself."),(0,i.mdx)("li",{parentName:"ol"},"Once the worker's job is done, it uploads the result back to the binary cloud storage and notifies Asset Compute\nservice it's done."),(0,i.mdx)("li",{parentName:"ol"},'Asset Compute service generates an asynchronous event via the "Adobe I/O Events" service and the processing flow\nfinishes.'),(0,i.mdx)("li",{parentName:"ol"},"Because of the asynchronous nature of the processing (AEM doesn't block itself waiting for a result), AEM has to\nperiodically poll the IO Events service for a given job ID to get its status."),(0,i.mdx)("li",{parentName:"ol"},"If the IO Events journal returns that the job is finished, AEM updates a JCR representation of the asset with the\ninfo about the generated renditions (links internally the JCR rendition node to the binary cloud storage where the\nrendition binary sits)")))}l.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-resources-custom-asset-compute-worker-aem-cloud-assets-md-e7d95666c4030791db11.js.map